!function(a){function b(a){return a.charAt(0).toUpperCase()+a.slice(1)}function c(a,b){for(;a.length<b;)a="0"+a;return a}function d(){return c(j(0,255).toString(16),2)+c(j(0,255).toString(16),2)+c(j(0,255).toString(16),2)}function e(){if(window.crypto&&window.crypto.getRandomValues&&-1===navigator.userAgent.indexOf("Safari")){for(var a=window.crypto.getRandomValues(new Uint32Array(3)),b="",c=0,d=a.length;d>c;c++)b+=a[c].toString(36);return b}return(Math.random()*(new Date).getTime()).toString(36).replace(/\./g,"")}function f(a,b){return Math.random()*(b-a)+a}function g(){var a=50;return{left:fabric.util.getRandomInt(0+a,700-a),top:fabric.util.getRandomInt(0+a,500-a)}}function h(a,b,c,d){function e(){return['<ul class="color-list clearfix">','  <li class="color-item black active"></li>','  <li class="color-item blue"></li>','  <li class="color-item red"></li>','  <li class="color-item green"></li>','  <li class="color-item orange"></li>','  <li class="color-item gray"></li>','  <li class="color-item purple"></li>',"</ul>"].join("")}function f(){return['<ul class="brush-list clearfix">','<li class="brush-item thin active"></li>','<li class="brush-item fine"></li>','<li class="brush-item medium"></li>','<li class="brush-item thick"></li>',"</ul>"].join("")}function g(){return['<button class="tool-item shape">','<ul class="shape-list">','  <li class="shape-item circle"></li>','  <li class="shape-item square"></li>','  <li class="shape-item triangle"></li>','  <li class="shape-item line"></li>',"</ul>","</button>"].join("")}function h(){var a=['<div id="drawToolbar" class="toolbar"><div class="toolbar-inner"><div class="btn-tool clearfix">'],b=d.tools;return b.zoomin?a.push('<button class="tool-item enlarge" title="放大">',"</button>"):"",b.zoomout?a.push('<button class="tool-item reduce" title="缩小">',"</button>"):"",b.redo?a.push('<button class="tool-item go-forward" title="前进">',"</button>"):"",b.undo?a.push('<button class="tool-item go-back" title="回退">',"</button>"):"",b.image?a.push('<button class="tool-item add-picture" title="图片">',"</button>"):"",b.move?a.push('<button class="tool-item move" title="拖动">','<i class="icons icons-draft"></i>',"</button>"):"",b.selection?a.push('<button class="tool-item selector" title="移动">',"</button>"):"",b.pen?a.push('<button class="tool-item pen active"><div class="pen-list" style="display:none;">',f(),e(),"</div></button>"):"",b.eraser?a.push('<button class="tool-item eraser" title="橡皮">',"</button>"):"",b.shape?a.push(g()):"",b.text?a.push('<button class="tool-item text" title="文字"></button>'):"",b.eraserall?a.push('<button class="tool-item eraser-all" title="清屏"></button>'):"",b.toimage?a.push('<button class="tool-item save" title="生成">',"</button>"):"",a.push("</dvi>"),a.join("")}return b=b||"50%",c=c||"50%",['<canvas id="'+a+'" width="'+b+'" height="'+c+'"></canvas>','<div class="toolbar">','<div class="toolbar-inner">',h(),"</div>","</div></div></div>"].join("")}function i(a,b,c,d){var e,f,c=c||900,d=d||1e3,g=c/d,h=a/b;return b>=d&&a<c?(e=d*a/b,f=d):b<d&&a>=c?(f=c*b/a,e=c):a<=c&&b<=d?(e=a,f=b):h>=g&&a>c&&b>d?(e=c,f=c*b/a):h<g&&a>c&&b>d&&(f=d,e=d*a/b),a=parseInt(e),b=parseInt(f),{Width:a,Height:b}}var j=fabric.util.getRandomInt,k=function(a){return function(){var b=document.createElement("input");try{b.type=a}catch(a){}return b.type===a}},l=k("range"),m=k("color");a.getRandomNum=f,a.getRandomInt=j,a.getRandomColor=d,a.getRandomLeftTop=g,a.supportsSlider=l,a.supportsColorpicker=m,a.capitalize=b,a.createToolsBar=h,a.getRandomId=e,a.getImageSize=i}(this);